{"version":3,"sources":["../src/mines.js"],"names":["minesScript","document","getElementById","mainDiv","createElement","id","body","insertBefore","minesPercent","value","addEventListener","GenerateField","getButtonAround","a","b","CheckBoom","btnClicked","disabled","v","parseInt","innerHTML","arr","split","btn","getMineAround","fieldData","isNaN","e","ButtonHandler","target","fieldWidth","fieldHeight","i1","fieldLine","j1","mp","minesCount","Math","round","minesMined","tmpI","floor","random","tmpJ","i","p","appendChild","j","btnId","minesAround"],"mappings":"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","file":"mines.js","sourcesContent":["ï»¿// jshint esversion: 6\r\n(function () {\r\n    let minesScript = document.getElementById(\"minesScript\");\r\n    let mainDiv = document.createElement(\"div\");\r\n    mainDiv.id = \"mainDiv\";\r\n    document.body.insertBefore(mainDiv, minesScript);\r\n    let minesPercent = document.getElementById(\"minesPercent\");\r\n    minesPercent.value = 10;\r\n    minesPercent.addEventListener(\"change\", function () { GenerateField(); });\r\n    GenerateField();\r\n}());\r\nfunction getButtonAround(a, b) { return document.getElementById(`btn_${a}_${b}`); }\r\nfunction CheckBoom(btnClicked) {\r\n    if (!btnClicked.disabled) {\r\n        let v = parseInt(btnClicked.value);\r\n        btnClicked.disabled = true;\r\n        if (9 == v) {\r\n            btnClicked.innerHTML = \"<img />\";\r\n        }\r\n        else {\r\n            /*TODO: change later by using Template literals + Babel (IE11 does not support it directly) */\r\n            btnClicked.innerHTML = \"<span class=\\\"sc\" + v + \"\\\">\" + v + \"</span>\";\r\n            let arr = btnClicked.id.split(\"_\");\r\n            let a = parseInt(arr[1]);\r\n            let b = parseInt(arr[2]);\r\n            if (0 == btnClicked.value) {\r\n                let btn = getButtonAround(a - 1, b - 1); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a - 1, b); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a - 1, b + 1); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a, b - 1); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a, b + 1); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a + 1, b - 1); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a + 1, b); if (btn) { CheckBoom(btn); }\r\n                btn = getButtonAround(a + 1, b + 1); if (btn) { CheckBoom(btn); }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction getMineAround(a, b, fieldData) {\r\n    try {\r\n        return (isNaN(fieldData[a][b])) ? 0 : fieldData[a][b];\r\n    }\r\n    catch (e) {\r\n        return 0;\r\n    }\r\n}\r\nfunction ButtonHandler() {\r\n    return function (e) { CheckBoom(e.target); };\r\n}\r\nfunction GenerateField() {\r\n    let mainDiv = document.getElementById(\"mainDiv\");\r\n    mainDiv.innerHTML = \"\";\r\n    let fieldWidth = 10;\r\n    let fieldHeight = 10;\r\n    let fieldData = [];\r\n    for (let i1 = 0; i1 < fieldHeight; i1++) {\r\n        let fieldLine = [];\r\n        for (let j1 = 0; j1 < fieldWidth; j1++) {\r\n            fieldLine[j1] = 0;\r\n        }\r\n        fieldData[i1] = fieldLine;\r\n    }\r\n    let minesPercent = document.getElementById(\"minesPercent\");\r\n    let mp = parseInt(minesPercent.value);\r\n    let minesCount = Math.round(fieldHeight * fieldWidth * (mp / 100));\r\n    let minesMined = 0;\r\n    while (minesMined < minesCount) {\r\n        let tmpI = Math.floor(Math.random() * fieldHeight);\r\n        let tmpJ = Math.floor(Math.random() * fieldWidth);\r\n        if (fieldData[tmpI][tmpJ] == 0) {\r\n            fieldData[tmpI][tmpJ] = 1;\r\n            minesMined++;\r\n        }\r\n    }\r\n    for (let i = 0; i < fieldHeight; i++) {\r\n        let p = document.createElement(\"p\");\r\n        mainDiv.appendChild(p);\r\n        for (let j = 0; j < fieldWidth; j++) {\r\n            let btn = document.createElement(\"button\");\r\n            p.appendChild(btn);\r\n            let btnId = \"btn_\" + i + \"_\" + j;\r\n            btn.id = btnId;\r\n            if (1 == fieldData[i][j]) {\r\n                btn.value = 9;\r\n            }\r\n            else {\r\n                let minesAround = 0;\r\n                minesAround += getMineAround(i - 1, j - 1, fieldData);\r\n                minesAround += getMineAround(i - 1, j, fieldData);\r\n                minesAround += getMineAround(i - 1, j + 1, fieldData);\r\n                minesAround += getMineAround(i, j - 1, fieldData);\r\n                minesAround += getMineAround(i, j + 1, fieldData);\r\n                minesAround += getMineAround(i + 1, j - 1, fieldData);\r\n                minesAround += getMineAround(i + 1, j, fieldData);\r\n                minesAround += getMineAround(i + 1, j + 1, fieldData);\r\n                btn.value = minesAround;\r\n            }\r\n            btn.addEventListener(\"click\", ButtonHandler());\r\n        }\r\n    }\r\n}\r\n"]}